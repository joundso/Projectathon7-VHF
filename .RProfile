
### This file is only needed when DUP is operated manually, without using docker


#################################################
### SHARED OPTIONS FOR RETRIEVAL AND ANALYSIS ###
#################################################

### DECENTRAL_ANALYSIS
### ------------------
### Default: TRUE
###   TRUE = Die Ergebnisse des Retrieval werden in das Verzeichnis
###          outputLocal geschrieben (das nicht ausgeleitet werden
###          soll). Die Analyse liest dann die Ergebnisse des
###          Retrieval aus dem outputLocal und schreibt ihre
###          Ergebnisse ins Verzeichnis outputGlobal (was dann
###          ausgeleitet wird).
###  FALSE = Die Ergebnisse des Retrieval werden in das Verzeichnis
###          outputGlobal geschrieben (das ausgeleitet wird). Auch
###          wenn bei dieser Option die Analyse eigentlich nicht im
###          DIZ ausgeführt werden sollte, kann man sie dennoch
###          ausführen und auch sie schreibt ihre Ergebnisse in
###          outputGlobal.
# Sys.setenv(DECENTRAL_ANALYSIS = "TRUE")

### DEBUG
### -----
### Default: "FALSE"
###   TRUE = Zwischenergebnisse werden ins Verzeichnis outputLocal
###           geschrieben
###  FALSE = es werden keine Zwischenergebnisse rausgeschrieben
# Sys.setenv(DEBUG = "FALSE")


#################
### RETRIEVAL ###
#################

### FHIR_SERVER_ENDPOINT
### --------------------
### FHIR Endpoint (muss gesetzt werden)
### Default: -
### Hier ist als Beispiel ein Hapi und ein Blaze Testserver ohne Authentifizierung angegeben:
# Sys.setenv(FHIR_SERVER_ENDPOINT = "https://mii-agiop-3p.life.uni-leipzig.de/fhir")
Sys.setenv(FHIR_SERVER_ENDPOINT = "https://mii-agiop-3p.life.uni-leipzig.de/blaze")

### FHIR_SERVER_USER und FHIR_SERVER_PASS
### -------------------------------------
### Falls Authentifizierung, bitte entsprechend anpassen (sonst ignorieren):
### Username und Passwort für Basic Auth
### Default: -
# Sys.setenv(FHIR_SERVER_USER = "myusername")
# Sys.setenv(FHIR_SERVER_PASS = "mypassword")

### FHIR_SERVER_TOKEN
### -----------------
### Alternativ: Token für Bearer Token Auth
### Default: -
# Sys.setenv(FHIR_SERVER_TOKEN = "mytoken")

### SSL_VERIFY
### ----------
### SSL peer verification angeschaltet lassen?
### Default: TRUE
### TRUE = peer verification anschalten
### FALSE = peer verification ausschalten
# Sys.setenv(SSL_VERIFY = "TRUE")

### MAX_BUNDLES
### -----------
### Das Script lädt zuerst alle passenden Observations,
### davon ausgehend zugehörige Patienten und Conditions.
###    Default: "Inf"
###       Inf = Alle Observaton Bundles werden herunter geladen.
### 1, 2, ... = Maximal wird diese Anzahl Observaton Bundles herunter
###             geladen.
# Sys.setenv(MAX_BUNDLES = "Inf")

### VERBOSE
### -------
### Default: 0 (= keine Ausgabe)
### 0 .. 4 = Verbose-Level des fhircrackr
# Sys.setenv(VERBOSE = "0")

### PROFILE_ENC
### -----------
### FHIR Profile der zu ladenden Encounter. Es werden nur
### Encounter mit dem angegebenen Profil gefunden.
### Default: "https://www.medizininformatik-initiative.de/fhir/core/modul-fall/StructureDefinition/KontaktGesundheitseinrichtung"
###  EMPTY = Wenn kein Profil in der Abfrage gesetzt werden soll, muss dieses Schlüsselwort angegeben werden. 
# Sys.setenv(PROFILE_ENC = "EMPTY")
# Sys.setenv(PROFILE_ENC = "https://www.medizininformatik-initiative.de/fhir/core/modul-fall/StructureDefinition/KontaktGesundheitseinrichtung")

### PROFILE_OBS
### -----------
### FHIR Profile der zu ladenden Observations. Es werden nur
### Observations mit dem angegebenen Profil gefunden.
### Default: https://www.medizininformatik-initiative.de/fhir/core/modul-labor/StructureDefinition/ObservationLab
###  EMPTY = Wenn kein Profil in der Abfrage gesetzt werden soll, muss dieses Schlüsselwort angegeben werden. 
# Sys.setenv(PROFILE_OBS = "EMPTY")
# Sys.setenv(PROFILE_OBS = "https://www.medizininformatik-initiative.de/fhir/core/modul-labor/StructureDefinition/ObservationLab")

### PROFILE_CON
### -----------
### FHIR Profile der zu ladenden Conditions. Es werden nur
### Conditions mit dem angegebenen Profil gefunden.
### Default: https://www.medizininformatik-initiative.de/fhir/core/modul-diagnose/StructureDefinition/Diagnose
###  EMPTY = Wenn kein Profil in der Abfrage gesetzt werden soll, muss dieses Schlüsselwort angegeben werden. 
# Sys.setenv(PROFILE_CON = "EMPTY")
# Sys.setenv(PROFILE_CON = "https://www.medizininformatik-initiative.de/fhir/core/modul-diagnose/StructureDefinition/Diagnose")

### FHIR_SEARCH_SUBJECT_LIST_OPTION
### -------------------------------
### Dieser Parameter legt fest, wie die Encounter und Conditions per fhir_search(...)-Anfrage eingeschränkt auf die
### subject-IDs der zuvor geladenen NTproBNP-Observationen heruntergeladen werden sollen. Der Default 
### COMMA_SEPARATED_PURE_IDS sollte bei Hapi und Blaze Servern funktionieren, bei Firely-Servern kam es zu Problemen.
### Auf allen Servern funktioniert die Option COMMA_SEPARATED_IDS_WITH_PATIENT_PREFIX. Allerdings passen dann weniger
### IDs gleichzeitig in eine Anfrage, da von den maximal 2048 Zeichen der get-Anfrage pro subject-ID die Länge für
### den Präfix "Patient/" verloren geht und dadurch mehr Anfragen generiert werden müssen, was die Downloadzeit je
### nach Datenmenge verlängert.
### 
### Default: "COMMA_SEPARATED_PURE_IDS"
###
### List request options for request with multiple subject IDs:
### ...........................................................
### COMMA_SEPARATED_PURE_IDS
###    $fhirServerEndpoint/Encounter?subject=PID01,PID02,PID...&type=einrichtungskontakt&_profile=$PROFILE_ENC
###    $fhirServerEndpoint/Condition?subject=PID01,PID02,PID...&_profile=$PROFILE_CON
###
### COMMA_SEPARATED_PURE_IDS_WITH_SUBJECT_PATIENT
###    $fhirServerEndpoint/Encounter?subject:Patient=PID01,PID02,PID...&type=einrichtungskontakt&_profile=$PROFILE_ENC
###    $fhirServerEndpoint/Condition?subject:Patient=PID01,PID02,PID...&_profile=$PROFILE_CON
###
### COMMA_SEPARATED_IDS_WITH_PATIENT_PREFIX
###    $fhirServerEndpoint/Encounter?subject=Patient/PID01,Patient/PID02,...&type=einrichtungskontakt&_profile=$PROFILE_ENC
###    $fhirServerEndpoint/Condition?subject=Patient/PID01,Patient/PID02,...&_profile=$PROFILE_CON
###
### Request options for multiple requests with a single subject ID:
### .............................................................. 
### Diese Optionen sollten (wenn es kein Blaze ist) möglichst nur zum Testen genutzt werden oder als absoluter Fallback,
### falls keine der obigen Optionen funktioniert. Diese Requests mit nur einer subject ID dauern sehr viel länger (Hapi
### statt 55 sek -> 25 min = ca. Faktor 25 und Blaze statt 35 sek -> 1:40 min = ca. Faktor 3 jeweils auf demselben
### Datensatz)
###
### SINGLE_REQUEST_PER_ID
###    $fhirServerEndpoint/Encounter?subject=PID01&type=einrichtungskontakt&_profile=$PROFILE_ENC
###    $fhirServerEndpoint/Condition?subject=PID01&_profile=$PROFILE_CON
###
### SINGLE_REQUEST_PER_ID_WITH_SUBJECT_PATIENT
###    $fhirServerEndpoint/Encounter?subject:Patient=PID01&type=einrichtungskontakt&_profile=$PROFILE_ENC
###    $fhirServerEndpoint/Condition?subject:Patient=PID01&_profile=$PROFILE_CON
###
### SINGLE_REQUEST_PER_ID_WITH_PATIENT_PREFIX
###    $fhirServerEndpoint/Encounter?subject=Patient/PID01&type=einrichtungskontakt&_profile=$PROFILE_ENC
###    $fhirServerEndpoint/Condition?subject=Patient/PID01&_profile=$PROFILE_CON
###
### Query option to get all Encounters and Conditions on the server (useful if resources on the server are already
### filtered):
### ..............................................................................................................
### IGNORE_IDS
###    $fhirServerEndpoint/Encounter?einrichtungskontakt&_profile=$PROFILE_ENC
###    $fhirServerEndpoint/Condition?_profile=$PROFILE_CON
###
### optimal für Hapi und Blaze (ist auch der Default)
# Sys.setenv(FHIR_SEARCH_SUBJECT_LIST_OPTION = "COMMA_SEPARATED_PURE_IDS")
### für Firely, aber funktioniert auch für Hapi und Blaze
# Sys.setenv(FHIR_SEARCH_SUBJECT_LIST_OPTION = "COMMA_SEPARATED_IDS_WITH_PATIENT_PREFIX")
Sys.setenv(FHIR_SEARCH_SUBJECT_LIST_OPTION = "COMMA_SEPARATED_PURE_IDS")


################
### ANALYSIS ###
################

### DATA_QUALITY_REPORT
### -------------------
### Default: "TRUE"
###   TRUE = Data Quality Report im outputGlobal erstellen (Default)
###  FALSE = Data Quality Report nicht erstellen
# Sys.setenv(DATA_QUALITY_REPORT = "TRUE")


### Repository to download R-Packages from
### Has to be adjusted, see README
options(repos = c(RSPM = "https://packagemanager.rstudio.com/cran/2022-06-22"))
